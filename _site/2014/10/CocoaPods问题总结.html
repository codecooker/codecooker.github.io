<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="" />
    <title>CocoaPods问题总结 | </title>
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="/feed/" rel="alternate" title="" type="application/atom+xml" />
    <link rel="stylesheet" href="/media/css/style.css">
    <link rel="stylesheet" href="/media/css/highlight.css">
    <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>
  </head>
  <script type="text/javascript">
    function setTimeSpan(){
    	var date = new Date();
    	timeSpan.innerText=date.format('yyyy-MM-dd hh:mm:ss');
    }
    
    Date.prototype.format = function(format)
		{
    var o =
    	{
    	    "M+" : this.getMonth()+1, //month
    	    "d+" : this.getDate(),    //day
    	    "h+" : this.getHours(),   //hour
    	    "m+" : this.getMinutes(), //minute
    	    "s+" : this.getSeconds(), //second
    	    "q+" : Math.floor((this.getMonth()+3)/3),  //quarter
    	    "S" : this.getMilliseconds() //millisecond
    	}
    	if(/(y+)/.test(format))
    	format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4 - RegExp.$1.length));
    	for(var k in o)
    	if(new RegExp("("+ k +")").test(format))
    	format = format.replace(RegExp.$1,RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length));
    	return format;
		}
  </script>
  <body onLoad="setInterval(setTimeSpan,1000);">
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>CocoaPods问题总结</h1>
        </header>
        <nav>
        <span><a title="home page" class="" href="/">Home</a></span>
        <span><a title="categories" class="" href="/categories/">Categories</a></span>
        <span><a title="tags" class="" href="/tags/">Tags</a></span>
        <span><a title="about" class="" href="/about/">About</a></span>
        <!-- <span><a title="links" class="" href="/links/">Links</a></span> -->
        <span><a title="Github" class="" href="https://github.com/codecooker">Github</a></span>
        </nav>
        <article class="content">
        <section class="post">
<p>在项目接入<strong>cocoapods</strong>后，打包机器打包方面暴漏和很多问题。总会莫名其妙的发生错误，让大家手足无措。<br>
这里我来总结下常见的一些问题的处理方案，方便大家在日后的项目测试中做到有的放矢。  </p>

<h4>1.找不到相应的库</h4>

<p>找不到相应的库的问题，我碰到的有两个原因<br>
1.打包机器没有添加<strong>framework</strong>对应的源（如何添加源，请继续往下看）<br>
2.本地<strong>cocoapods</strong>的版本与<strong>打包机器</strong>上<strong>cocoapods</strong>的版本不一致，这个问题通常是由于本地的版本高于MTL版本造成的</p>

<h4>2.找不到相应的<strong>target</strong></h4>

<p>由于工程的迁移，或者开发人员的误操作，会造成本地<strong>target</strong>的丢失。这样在命令行打包过程中，会暴找不到<strong>target</strong>的错误，这时我们只需要将针对与个人的<strong>target</strong>设置成<strong>shared</strong>即可，如下:<br>
<img src="/images/CocoaPods%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/Snip20141028_7.png" alt="设置target为shared"><br>
<strong><em>重要:这里需要注意的一点是我们的更改怎么提交到git上，如果大家这样操作后会发现git并没有跟踪到任何变化，我们无所提交。其实我们只需要在git托管的目录下找到.gitignore文件(这是一个隐藏文件，如果不清楚这个文件是做什么的，自行恶补),彩票的文件内容如下</em></strong></p>

<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="p">.</span><span class="n">DS_Store</span>

<span class="n">build</span><span class="o">/*</span>
<span class="n">docs</span><span class="o">/*</span>
<span class="p">.</span><span class="n">svn</span><span class="o">/</span>

<span class="cp"># Xcode</span>
<span class="o">*</span><span class="p">.</span><span class="n">pbxuser</span>
<span class="o">*</span><span class="p">.</span><span class="n">mode1v3</span>
<span class="o">*</span><span class="p">.</span><span class="n">mode2v3</span>
<span class="o">*</span><span class="p">.</span><span class="n">perspectivev3</span>
<span class="o">*</span><span class="p">.</span><span class="n">xcuserstate</span>
<span class="o">*</span><span class="p">.</span><span class="n">xcworkspace</span>
<span class="n">xcuserdata</span>
<span class="o">*</span><span class="p">.</span><span class="n">xcscheme</span>
<span class="o">*</span><span class="p">.</span><span class="n">xccheckout</span>
<span class="n">profile</span>
<span class="o">*</span><span class="p">.</span><span class="n">moved</span><span class="o">-</span><span class="n">aside</span>
<span class="n">DerivedData</span>
<span class="o">*</span><span class="p">.</span><span class="n">hmap</span>
<span class="o">*</span><span class="p">.</span><span class="n">ipa</span>
<span class="n">Pods</span>
<span class="p">.</span><span class="n">idea</span>
<span class="n">contents</span><span class="p">.</span><span class="n">xcworkspacedata</span></code></pre></div>
  

<p><strong><em>我们需要暂时屏蔽对</em>.xcscheme文件的过滤，然后就能看到更改，接下来commit-&gt;push</strong></p>

<h4>3.本地升级cocoapods后与MTL版本不一致</h4>

<p>这个问题通常<strong>不会直接抛出</strong>是由于本地<strong>cocoapods</strong>版本与打包机器<strong>cocoapods</strong>版本不一致的错误异常<br>
通常的展现方式会以在编译的时候<strong>找不到某个库的错误</strong>暴露出来，如:  </p>

<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="nl">error</span><span class="p">:</span> <span class="err">&#39;</span><span class="n">XXXFramework</span><span class="o">/</span><span class="n">XXXFramework</span><span class="p">.</span><span class="n">h</span><span class="err">&#39;</span> <span class="n">file</span> <span class="n">not</span> <span class="n">found</span>
    <span class="cp">#import &quot;XXXFramework/XXXFramework.h&quot;</span>
            <span class="o">^</span>
<span class="mi">1</span> <span class="n">error</span> <span class="n">generated</span><span class="p">.</span></code></pre></div>

<p>在确定了已经添加相应的源且获得了相应的权限后,碰到类似诡异的问题,可以翻看<em>log</em>文件的前面,查看是否有生成<strong>podfile.lock</strong>的<strong>cocoapods</strong>版本号和打包机器的<strong>cocoapods</strong>版本号不一致的警告。<br>
如下:<br>
<code>[!] The version of CocoaPods used to generate the lockfile (0.34.2) is higher than the version of the current executable (0.33.1). Incompatibility issues may arise.</code><br>
当看到如此的警告时我们可以按照如下步骤进行处理<br>
1.删除工程内的<strong>Pods</strong>文件夹<br>
2.删除工程内的<strong>xcworkspace</strong>的文件<br>
3.删除<strong>Podfile.lock</strong>文件<br>
4.打开<strong>xcodeproj</strong>,注意不是<strong>xcworkspace</strong>,在左边树形结构文件处删除<strong>Pods</strong>文件夹  </p>

<p><img src="/images/CocoaPods%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/Snip20141028_3.png" alt="pods文件夹图片"><br>
5.删除功能内对<strong>Pod</strong>产生<strong>target</strong>的引用<br>
6.删除<strong>Pod</strong>产生的一些配置信息如图<br>
<img src="/images/CocoaPods%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/Snip20141028_5.png" alt="pods文件夹图片">
图中的<strong>第二项</strong>和<strong>最后一项</strong><br>
7.提交代码打包</p>

<h4>PS:其他涉及到的问题，大家熟悉cocoapods的话，应该都能搞定。如果还诡异问题也可以和我沟通，相信以后大家都能搞定摩天轮打包失败的问题了，哈哈！</h4>

<h4>注:cocoapods常见低级问题解答</h4>

<h6>1.如何添加源</h6>

<p><code>pod repo add [source_name] [source_path];</code>  </p>

<p>其中source<em>name指为源起的名称，可以根据自己的喜好，但是不要和本地源重名。source</em>path为我们真是源的一个git地址，注意源的git权限通常需要设置为<strong>public</strong><br>
升级cocoapods到最新版后，我们也可以这样使用<br>
在podfile里添加如下代码指定该podfile内涉及的库从哪些源里获取  </p>

<p><code>source [source_path];</code></p>

<h6>2.是否需要提交Podfile.lock</h6>

<p>这是CocoaPods创建的最重要的文件之一。它记录了需要被安装的pod的每个已安装的版本。如果你想知道已安装的pod是哪个版本，可以查看这个文件。推荐将Podfile.lock文件加入到版本控制中，这有助于整个团队的一致性。 </p>

<h6>3.Manifest.lock是干什么的,为什么一致报错</h6>

<p>这是每次运行pod install时创建的Podfile.lock文件的副本。如果大家遇到过这个错误：</p>

<p><code>diff: /../Podfile.lock: No such file or directory diff: /Manifest.lock: No such file or directory error: The sandbox is not in sync with the Podfile.lock. Run &#39;pod install&#39; or update your CocoaPods installation.</code>  </p>

<p>由于Pods所在的目录并不总在版本控制之下，这样可以保证开发者运行app之前都能更新他们的pods，否则app可能会crash，或者在一些不太明显的地方编译失败.</p>

</section>
<section class="meta">
<br/>
<br/>
<span>
	<a  href="/2013/04/%E5%AE%9E%E7%8E%B0%E7%BB%84%E5%90%88%E7%9A%84C++%E4%BB%A3%E7%A0%81.html" class="pageNav"  >Previous</a>
	&nbsp;&nbsp;&nbsp;
	<a  href="/2014/12/iOS%E6%B5%8B%E9%87%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4.html" class="pageNav"  >Next</a>
</span>
<hr>
<span class="author">
  <a href="http://codecooker.github.com"></a>
</span>
<span class="time">
  /
  <time datetime="2014-10-28">2014-10-28</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="/categories/#cocoapods" title="cocoapods">cocoapods</a>&nbsp;
  
</span>


<span class="tags">
  tagged with 
  
  <a href="/tags/#cocoaPods" title="cocoaPods">cocoaPods</a>&nbsp;
  
  <a href="/tags/#iOS" title="iOS">iOS</a>&nbsp;
  
</span>

</section>
<!-- Duoshuo Comment BEGIN -->
    <div class="ds-thread"></div>
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"codecooker"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = 'http://static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
        || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
<!-- Duoshuo Comment END -->
<!--
<script type="text/javascript">
$(function(){
  $(document).keydown(function(e) {
    var url = false;
        if (e.which == 37 || e.which == 74) {  // Left arrow and J
            
        url = '/2013/04/%E5%AE%9E%E7%8E%B0%E7%BB%84%E5%90%88%E7%9A%84C++%E4%BB%A3%E7%A0%81.html';
        
        }
        else if (e.which == 39 || e.which == 75) {  // Right arrow and K
            
        url = '/2014/12/iOS%E6%B5%8B%E9%87%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4.html';
        
        }
        if (url) {
            window.location = url;
        }
  });
})
</script>
-->


        </article>
      </div>

    <footer>
        <p><small>Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a> & <a href="http://pages.github.com">GitHub</a> | Copyright 2012 - 2015 by <a href="/about/">codecooker</a> | <span class="label label-info" id="timeSpan"></span></small></p>
    </footer>

    </div>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-34960818-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <!-- Baidu Button BEGIN -->
		<script type="text/javascript" id="bdshare_js" data="type=slide&amp;img=4&amp;pos=right&amp;uid=541841" ></script>
		<script type="text/javascript" id="bdshell_js"></script>
		<script type="text/javascript">
		var bds_config={"bdTop":170};
		document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000);
		</script>
		<!-- Baidu Button END -->
  </body>
</html>
